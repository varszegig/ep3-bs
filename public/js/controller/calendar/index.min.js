!function(){var calendar,squarebox,squareboxShutdown=!1,squareboxOverlay,loadingDelay=300,animationDuration=350;function loadSquarebox(href){var calendarSquareboxTemplate=$("#calendar-squarebox-template");calendarSquareboxTemplate.length?populateSquarebox(calendarSquareboxTemplate.html()):populateSquarebox('<div class="padded">...</p>'),squarebox.clearQueue().delay(300).queue((function(){$.ajax({cache:!1,data:{ajax:!0},dataType:"html",error:function(){squarebox&&!squareboxShutdown&&(window.location.href=href)},success:function(data){squarebox&&!squareboxShutdown&&(populateSquarebox(data),squarebox.find(".no-ajax").remove(),squarebox.find(".datepicker").datepicker(),squarebox.find(".inline-label-container").each((function(){updateInlineLabel($(this))})),squarebox.append('<a href="#" class="squarebox-primary-close-link squarebox-close-link">&times;</a>'),updateSquarebox(),squarebox.on("click","a.squarebox-internal-link",(function(event){event.preventDefault(),loadSquarebox($(this).attr("href"))})),squarebox.on("click","a.squarebox-close-link",(function(event){event.preventDefault(),removeSquarebox()})))},url:href}),$(this).dequeue()}))}function prepareSquarebox(){squareboxOverlay||(squareboxOverlay=window.matchMedia("(min-width: 1024px)").matches?$('<div id="squarebox-overlay"></div>').css({position:"absolute","z-index":1532,opacity:0,width:$(document).width(),height:$(document).height(),left:0,top:0,background:"#333"}):$('<div id="squarebox-overlay"></div>').css({position:"absolute","z-index":1532,opacity:0,width:$(document).width(),height:"auto",left:0,top:0,background:"#333"}),$("body").prepend(squareboxOverlay)),squarebox||(squarebox=window.matchMedia("(min-width: 1024px)").matches?$('<div class="panel"></div>').css({position:"absolute","z-index":1536}):$('<div class="panel"></div>').css({position:"-webkit-sticky",position:"sticky",top:0,left:0,width:"90%","max-width":"90%","margin-left":"auto","margin-right":"auto","z-index":1536}),$("body").prepend(squarebox))}function populateSquarebox(content){prepareSquarebox(),squarebox.clearQueue(),squarebox.css("opacity",.01),squarebox.html(content),updateSquarebox(),squarebox.fadeTo(350,1),fadeOutContent()}function updateSquarebox(){var orientation;squarebox&&(orientation=$("body").height()>$(window).height()?window:calendar,squarebox.position({my:"center",at:"center",of:orientation}))}function removeSquarebox(){squarebox&&(squareboxShutdown=!0,squarebox.clearQueue().fadeOut(350,(function(){squarebox&&(squarebox.remove(),squarebox=void 0),squareboxShutdown=!1})),fadeInContent())}function fadeOutContent(){squareboxOverlay&&squareboxOverlay.clearQueue().fadeTo(350,.75)}function fadeInContent(){squareboxOverlay&&squareboxOverlay.clearQueue().fadeTo(350,0,(function(){squareboxOverlay&&(squareboxOverlay.remove(),squareboxOverlay=void 0)}))}function updateCalendarCols(){var calendarWidth=$("#calendar").width(),calendarLegendColWidth=$(".calendar-time-col, .calendar-square-col").width(),calendarDateCols=$(".calendar-date-col:visible");calendarWidth&&calendarLegendColWidth&&calendarDateCols.length&&calendarDateCols.width(Math.floor((calendarWidth-calendarLegendColWidth)/calendarDateCols.length))}function updateCalendarEvents(){$(".calendar-date-col").each((function(dateIndex){var calendarDateCol=$(this),eventGroups=[];calendarDateCol.find(".cc-event").each((function(){var classes,eventGroup=$(this).attr("class").match(/cc-group-\d+/);eventGroup&&-1===$.inArray(eventGroup,eventGroups)&&eventGroups.push(eventGroup)}));for(var eventGroupsLength=eventGroups.length,i=0;i<=eventGroupsLength;i++){var eventGroup=eventGroups[i]+"",eventGroupCellFirst=calendarDateCol.find("."+eventGroup+":first"),eventGroupCellLast=calendarDateCol.find("."+eventGroup+":last"),posFirst=eventGroupCellFirst.position(),posLast=eventGroupCellLast.position();if(posFirst&&posLast){var startX=Math.floor(posFirst.left)-1,startY=Math.floor(posFirst.top)-1,endX=Math.ceil(posLast.left)+1,endY=Math.ceil(posLast.top)+1,eventWidth=Math.round(endX+eventGroupCellLast.outerWidth()-startX),eventHeight=Math.round(endY+eventGroupCellLast.outerHeight()-startY),eventGroupOverlay=$("#"+eventGroup+"-overlay-"+dateIndex),eventGroupOverlayLabel=eventGroupOverlay.find(".cc-label");eventGroupOverlay.css({position:"absolute","z-index":128,left:startX,top:startY,width:eventWidth,height:eventHeight,padding:0}),eventGroupOverlayLabel.css({height:"auto","font-size":"12px","line-height":1.5}),eventGroupOverlayLabel.css({position:"relative",top:Math.round(eventHeight/2-eventGroupOverlayLabel.height()/2)})}}}))}$(document).ready((function(){(calendar=$(".calendar-table")).on("click","a.calendar-cell",(function(event){var that=$(this);that.hasClass("squarebox-external-link")||(event.preventDefault(),squarebox||(event.stopPropagation(),loadSquarebox(that.attr("href"))))})),$(window).resize(updateSquarebox),$(window).on("squarebox.update",updateSquarebox),$("body").on("click","#squarebox-overlay",(function(){removeSquarebox()})),$("a.calendar-cell").hover((function(){var that=$(this),classes,group=that.attr("class").match(/cc-group-\d+/);if(group){var groupMembers=$("a."+group);groupMembers.each((function(){$(this).data("original-style",$(this).attr("style"))})),groupMembers.css({opacity:.9,"background-color":that.css("background-color")}),that.css("opacity",1)}}),(function(){var that,classes,group=$(this).attr("class").match(/cc-group-\d+/),groupMembers;group&&$("a."+group).each((function(){$(this).attr("style",$(this).data("original-style"))}))})),updateCalendarCols(),$(window).resize(updateCalendarCols),$(document).on("updateLayout",updateCalendarCols),updateCalendarEvents(),$(window).resize(updateCalendarEvents),$(document).on("updateLayout",updateCalendarEvents)}))}();